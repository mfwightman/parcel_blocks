--Creates table with all the nodes in the lost parcel block adjustments including their geometry--
--To be used with creating the lost parcel block script--
CREATE TABLE
    mawightman.pb_nodes AS
SELECT
    coo.id AS node_id,
    orj.adj_id AS adjustment_id,
    adj.description,
    --orj.adjust_fixed,
    --orj.rejected,
    --orj.coo_id_output,
    nod.shape
   
    --orj.constraint,
    --coo.value1,
    --coo.value2
FROM
    bde.crs_adjustment_run adj
    LEFT JOIN bde.crs_ordinate_adj orj ON adj.id = orj.adj_id
    LEFT JOIN bde.crs_coordinate coo ON orj.coo_id_source = coo.id
    LEFT JOIN bde.crs_node nod ON coo.nod_id = nod.id
WHERE
    --adj.description LIKE 'HK%' 
    adj.id IN ('3909',
'3904',
'3905',
'3907',
'3895',
'3776',
'3911',
'3906',
'801',
'794',
'865',
'677',
'856',
'678',
'860',
'818',
'1166',
'346',
'353',
'349',
'142',
'151',
'148',
'4579',
'176',
'253',
'251',
'4651',
'108',
'135',
'141',
'111',
'137',
'374',
'425',
'499',
'586',
'585',
'963',
'768',
'290',
'104',
'160',
'147',
'317',
'347',
'67',
'356',
'352',
'417',
'348',
'637',
'580',
'372',
'500',
'863',
'868',
'770',
'864',
'862',
'557',
'817',
'697',
'797',
'505',
'509',
'974',
'911',
'979',
'975',
'909',
'949',
'973',
'977',
'915',
'926',
'919',
'931',
'929',
'976',
'960',
'927',
'456',
'4511',
'4562',
'4530',
'4559',
'4369',
'4560',
'4237',
'4587',
'4544',
'4594',
'4628',
'4626',
'4536',
'4556',
'4558',
'4629',
'219',
'223',
'217',
'205',
'218',
'207',
'192',
'232',
'200',
'211',
'230',
'214',
'759',
'795',
'923',
'820',
'805',
'747',
'746',
'695',
'675',
'765',
'781',
'775',
'880',
'881',
'597',
'731',
'757',
'891',
'741',
'764',
'778',
'916',
'745',
'633',
'815',
'627',
'796',
'670',
'760',
'922',
'947',
'422',
'424',
'370',
'506',
'526',
'504',
'386',
'388',
'364',
'525',
'427',
'400',
'429',
'478',
'490',
'502',
'465',
'521',
'96',
'94',
'3184',
'2955',
'3115',
'2974',
'2908',
'2913',
'3117',
'2785',
'2854',
'2780',
'2805',
'2728',
'2855',
'2842',
'2808',
'2777',
'2694',
'2794',
'2778',
'2783',
'2784',
'2710',
'2716',
'2729',
'2678',
'2772',
'2776',
'2732',
'1725',
'2727',
'1966',
'2733',
'2734',
'2750',
'1901',
'1908',
'1961',
'1881',
'1904',
'1905',
'1755',
'1645',
'1559',
'1722',
'1667',
'1720',
'1595',
'1459',
'1612',
'1619',
'1620',
'1756',
'1668',
'1849',
'1836',
'1740',
'1820',
'1952',
'1837',
'1821',
'1830',
'1808',
'1669',
'1981',
'1838',
'1705',
'1984',
'1819',
'1953',
'2030',
'1907',
'1986',
'1922',
'2068',
'2042',
'2031',
'2145',
'2144',
'1910',
'1923',
'1567',
'1401',
'1453',
'1376',
'1310',
'1399',
'1359',
'1402',
'1379',
'1078',
'1366',
'1375',
'1180',
'1198',
'1255',
'1192',
'1176',
'1193',
'1179',
'1059',
'1350',
'1120',
'1066',
'1389',
'1400',
'1397',
'1833',
'1675',
'1598',
'1549',
'1608',
'1525',
'1524',
'1533',
'1412',
'1462',
'1428',
'1550',
'1388',
'1364',
'1463',
'1430',
'1614',
'1365',
'1594',
'1799',
'1621',
'1797',
'1798',
'1709',
'1689',
'1644',
'1831',
'1918',
'1882',
'1757',
'1919',
'1894',
'1888',
'2241',
'1733',
'1880',
'2107',
'1914',
'2018',
'1912',
'2115',
'2022',
'2035',
'2078',
'2079',
'2180',
'2178',
'2191',
'2084',
'1988',
'2210',
'2206',
'2199',
'2424',
'2246',
'2237',
'2209',
'2259',
'2151',
'2363',
'2298',
'2299',
'2302',
'2356',
'2309',
'2362',
'2393',
'2412',
'2401',
'2395',
'2421',
'2425',
'2561',
'2411',
'2378',
'2677',
'2389',
'2390',
'2562',
'2177',
'2147',
'2669',
'2415',
'2816',
'2744',
'2590',
'2565',
'2437',
'2681',
'2373',
'2374',
'2680',
'2899',
'2443',
'2557',
'2372',
'2544',
'2461',
'2623',
'2811',
'2806',
'2774',
'2795',
'2860',
'3066',
'2818',
'2820',
'2817',
'2840',
'2912',
'2895',
'2896',
'2902',
'2906',
'1194',
'1243',
'1221',
'1247',
'1199',
'1121',
'1046',
'1240',
'1062',
'1566',
'1688',
'1514',
'1967',
'1776',
'2304',
'2116',
'2914',
'2265',
'2181',
'1950',
'2307',
'2392',
'2300',
'2377',
'2382',
'2391',
'2433',
'2340',
'2345',
'2435',
'2522',
'2434',
'2516',
'2423',
'2328',
'2841',
'2518',
'2771',
'2907',
'2982',
'2878',
'2975',
'2959',
'2956',
'2957',
'3057',
'3058',
'3127',
'3055',
'3061',
'3077',
'3099',
'3073',
'3128',
'3123',
'3118',
'3011',
'3119',
'3097',
'3121',
'3113',
'3092',
'3122',
'3258',
'3234',
'3211',
'3213',
'3269',
'2990',
'3209',
'3208',
'3245',
'2952',
'3059',
'3116',
'3069',
'3144',
'3197',
'3133',
'1249',
'1256',
'1250',
'1254',
'1077',
'1172',
'1185',
'1195',
'1197',
'1196',
'2257',
'2773',
'3074',
'128',
'138',
'144',
'163',
'143',
'140',
'152',
'162',
'1457',
'1461',
'1557',
'1480',
'1551',
'1543',
'1960',
'1932',
'1937',
'1963',
'1929',
'1995',
'1938',
'1494',
'1758',
'1770',
'1927',
'2016',
'2053',
'2069',
'1925',
'1924',
'1928',
'1890',
'1604',
'1891',
'2047',
'2048',
'2009',
'2041',
'2074',
'2026',
'1403',
'2070',
'2051',
'2065',
'2020',
'2050',
'1850',
'2056',
'1252',
'2044',
'2164',
'1348',
'2186',
'2189',
'2108',
'2100',
'2122',
'2123',
'1322',
'2124',
'2247',
'2146',
'2195',
'2222',
'2125',
'2223',
'2252',
'2248',
'4292',
'4300',
'4342',
'4280',
'4339',
'4078',
'4291',
'4336',
'4359',
'3859',
'3795',
'3936',
'4017',
'3910',
'3962',
'3960',
'4015',
'3946',
'3941',
'3865',
'3719',
'3455',
'3860',
'3912',
'3933',
'3925',
'3923',
'3915',
'3930',
'3920',
'3866',
'3862',
'3861',
'3863',
'3720',
'3656',
'3644',
'3403',
'3456',
'3407',
'3743',
'3708',
'3707',
'3791',
'3784',
'3602',
'3625',
'3601',
'3619',
'3623',
'3597',
'3427',
'3618',
'3706',
'3418',
'3430',
'3462',
'3476',
'3793',
'3932',
'4025',
'3367',
'3546',
'3507',
'3353',
'3501',
'4252',
'3505',
'3499',
'3498',
'3491',
'3490',
'3495',
'3226',
'3475',
'3477',
'3428',
'3410',
'3429',
'3480',
'3445',
'3242',
'3479',
'3425',
'3187',
'3326',
'3423',
'3426',
'3349',
'3342',
'3146',
'3345',
'3348',
'3295',
'3380',
'3347',
'3464',
'3404',
'3388',
'3387',
'3363',
'3386',
'3230',
'3364',
'3346',
'3341',
'3306',
'3160',
'3634',
'3406',
'3622',
'3854',
'3739',
'3780',
'3942',
'3971',
'3945',
'4250',
'4021',
'4020',
'3697',
'3961',
'3696',
'3959',
'3773',
'3768',
'3740',
'4019',
'3734',
'3741',
'3792',
'3943',
'4218',
'4200',
'4198',
'4109',
'4296',
'4350',
'4293',
'4343',
'4308',
'4306',
'4221',
'4233',
'4231',
'4232',
'3973',
'4240',
'4307',
'4320',
'4337',
'4341',
'4210',
'4266',
'4262',
'3984',
'4271',
'4333',
'4009',
'4139',
'4002',
'4249',
'4143',
'4154',
'4163',
'4239',
'4242',
'4332',
'4358',
'4363',
'4360',
'4364',
'4374',
'4404',
'4410',
'4405',
'4408',
'4140',
'4394',
'4392',
'4393',
'4398',
'4391',
'3504',
'4613',
'4506',
'4507',
'4610',
'4612',
'4608',
'4611',
'4565',
'29',
'32',
'33',
'53',
'4283',
'30',
'54',
'45',
'511',
'510',
'508',
'445',
'507',
'501',
'647',
'645',
'657',
'692',
'690',
'664',
'703',
'699',
'701',
'448',
'444',
'685',
'581',
'595',
'688',
'687',
'497',
'4461',
'575',
'281',
'447',
'732',
'735',
'752',
'724',
'743',
'737',
'740',
'749',
'748',
'1177',
'1084',
'1009',
'1026',
'1007',
'769',
'1013',
'996',
'4680',
'1003',
'1011',
'1055',
'1043',
'582',
'1563',
'1476',
'2348',
'2316',
'1572',
'2489',
'2305',
'2405',
'2476',
'2453',
'2501',
'2499',
'2477',
'2428',
'2446',
'2429',
'2519',
'2442',
'2475',
'2747',
'2786',
'2751',
'2770',
'2933',
'2939',
'2966',
'3015',
'3060',
'3093',
'3020',
'2950',
'3082',
'3078',
'2978',
'4704',
'4705',
'4703',
'4700',
'3091',
'4699',
'4701',
'4692',
'4691',
'4702',
'4715',
'2813',
'4711',
'2752',
'4716',
'4710',
'4697',
'4853',
'4881',
'4774',
'4785',
'4802',
'4796',
'4795',
'4799',
'4800',
'4798',
'4776',
'5849',
'5847',
'5826',
'5822',
'5839',
'5846',
'5850',
'5841',
'5857',
'5858',
'5815',
'5414',
'5800',
'5801',
'5484',
'5413',
'5786',
'5808',
'5819',
'5694',
'5772',
'5381',
'5690',
'5696',
'5770',
'5771',
'5703',
'5520',
'5701',
'5784',
'5802',
'5760',
'5669',
'5671',
'5264',
'5668',
'5672',
'5555',
'5569',
'5512',
'5492',
'5812',
'5811',
'5807',
'5809',
'5436',
'5639',
'5775',
'5779',
'5738',
'5736',
'5737',
'5573',
'5568',
'5744',
'5313',
'5588',
'5622',
'5640',
'5626',
'5246',
'5519',
'5401',
'5518',
'5499',
'5505',
'5503',
'5511',
'5356',
'5480',
'5427',
'5395',
'5477',
'5210',
'5500',
'5378',
'5164',
'5169',
'5178',
'5404',
'5305',
'5396',
'5316',
'5298',
'5421',
'5296',
'5678',
'5263',
'5211',
'5202',
'5119',
'5120',
'4968',
'5301',
'5290',
'5214',
'5317',
'5312',
'5307',
'5252',
'5235',
'5234',
'5223',
'5070',
'5237',
'5228',
'5195',
'5041',
'5220',
'5230',
'4969',
'5204',
'5221',
'5143',
'5212',
'5125',
'5087',
'4939',
'4943',
'4726',
'4979',
'4957',
'4984',
'5076',
'5011',
'4981',
'4987',
'5012',
'4936',
'4995',
'4999',
'5013',
'5063',
'5004',
'5028',
'5018',
'5023',
'4743',
'4777',
'4874',
'5031',
'5035',
'5010',
'5016',
'5055',
'5047',
'5050',
'4816',
'5053',
'5086',
'5083',
'5088',
'5027',
'5071',
'5093',
'5067',
'4921',
'5089',
'5084',
'5121',
'4955',
'5109',
'5278',
'5279',
'4893',
'5117',
'2740',
'2757',
'2090',
'2554',
'2835',
'2829',
'2864',
'2863') 
    AND orj.constraint = 'FREE'
    AND orj.coo_id_output IS NOT NULL

--DROP TABLE mawightman.deletethis
